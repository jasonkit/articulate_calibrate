function J = get_jacobain(joint_param, theta, phi)

q = num2cell(joint_param.q_door);
[dw, dx, dy, dz] = q{:};
q = num2cell(joint_param.q_mirror);
[mw, mx, my, mz] = q{:};
q = num2cell(joint_param.q_cam);
[cw, cx, cy, cz] = q{:};

t = num2cell(joint_param.t_d2m);
[tmx, tmy, tmz] = t{:};
t = num2cell(joint_param.t_m2c);
[tcx, tcy, tcz] = t{:};

J = zeros(7,2);
J(1,1) = (dy^2*tmx - dx^2*tmx - dw^2*tmx + dz^2*tmx + 2*dw*dz*tmy - 2*dx*dy*tmy - 2*dw^2*mw*my*tcz - 2*dx^2*mw*my*tcz - 2*dw^2*mx*mz*tcz + 2*dy^2*mw*my*tcz - 2*dx^2*mx*mz*tcz + 2*dz^2*mw*my*tcz + 2*dy^2*mx*mz*tcz + 2*dz^2*mx*mz*tcz - 4*dw*dz*mw*mx*tcz + 4*dx*dy*mw*mx*tcz + 4*dw*dz*my*mz*tcz - 4*dx*dy*my*mz*tcz)*sin(theta) + (dy^2*tmy - dx^2*tmy - dw^2*tmy + dz^2*tmy - 2*dw*dz*tmx + 2*dx*dy*tmx + 2*dw^2*mw*mx*tcz + 2*dx^2*mw*mx*tcz - 2*dy^2*mw*mx*tcz - 2*dz^2*mw*mx*tcz - 2*dw^2*my*mz*tcz - 2*dx^2*my*mz*tcz + 2*dy^2*my*mz*tcz + 2*dz^2*my*mz*tcz - 4*dw*dz*mw*my*tcz + 4*dx*dy*mw*my*tcz - 4*dw*dz*mx*mz*tcz + 4*dx*dy*mx*mz*tcz)*cos(theta) + (- tcx*dw^2*mw^2 + 2*tcy*dw^2*mw*mz + tcx*dw^2*mz^2 + 2*tcy*dw*dz*mw^2 + 4*tcx*dw*dz*mw*mz - 2*tcy*dw*dz*mz^2 - tcx*dx^2*mw^2 + 2*tcy*dx^2*mw*mz + tcx*dx^2*mz^2 - 2*tcy*dx*dy*mw^2 - 4*tcx*dx*dy*mw*mz + 2*tcy*dx*dy*mz^2 + tcx*dy^2*mw^2 - 2*tcy*dy^2*mw*mz - tcx*dy^2*mz^2 + tcx*dz^2*mw^2 - 2*tcy*dz^2*mw*mz - tcx*dz^2*mz^2)*sin(phi + theta) + (tcx*dw^2*mx^2 + 2*tcy*dw^2*mx*my - tcx*dw^2*my^2 + 2*tcy*dw*dz*mx^2 - 4*tcx*dw*dz*mx*my - 2*tcy*dw*dz*my^2 + tcx*dx^2*mx^2 + 2*tcy*dx^2*mx*my - tcx*dx^2*my^2 - 2*tcy*dx*dy*mx^2 + 4*tcx*dx*dy*mx*my + 2*tcy*dx*dy*my^2 - tcx*dy^2*mx^2 - 2*tcy*dy^2*mx*my + tcx*dy^2*my^2 - tcx*dz^2*mx^2 - 2*tcy*dz^2*mx*my + tcx*dz^2*my^2)*sin(phi - theta) + (- tcy*dw^2*mw^2 - 2*tcx*dw^2*mw*mz + tcy*dw^2*mz^2 - 2*tcx*dw*dz*mw^2 + 4*tcy*dw*dz*mw*mz + 2*tcx*dw*dz*mz^2 - tcy*dx^2*mw^2 - 2*tcx*dx^2*mw*mz + tcy*dx^2*mz^2 + 2*tcx*dx*dy*mw^2 - 4*tcy*dx*dy*mw*mz - 2*tcx*dx*dy*mz^2 + tcy*dy^2*mw^2 + 2*tcx*dy^2*mw*mz - tcy*dy^2*mz^2 + tcy*dz^2*mw^2 + 2*tcx*dz^2*mw*mz - tcy*dz^2*mz^2)*cos(phi + theta) + (tcy*dw^2*mx^2 - 2*tcx*dw^2*mx*my - tcy*dw^2*my^2 - 2*tcx*dw*dz*mx^2 - 4*tcy*dw*dz*mx*my + 2*tcx*dw*dz*my^2 + tcy*dx^2*mx^2 - 2*tcx*dx^2*mx*my - tcy*dx^2*my^2 + 2*tcx*dx*dy*mx^2 + 4*tcy*dx*dy*mx*my - 2*tcx*dx*dy*my^2 - tcy*dy^2*mx^2 + 2*tcx*dy^2*mx*my + tcy*dy^2*my^2 - tcy*dz^2*mx^2 + 2*tcx*dz^2*mx*my + tcy*dz^2*my^2)*cos(phi - theta);
J(1,2) = (4*dw*dy*mw*my*tcx - 4*dw*dy*mw*mx*tcy - 4*dx*dz*mw*mx*tcy - 4*dw*dy*mx*mz*tcx + 4*dx*dz*mw*my*tcx - 4*dw*dy*my*mz*tcy - 4*dx*dz*mx*mz*tcx - 4*dx*dz*my*mz*tcy)*sin(phi) + (4*dw*dy*mw*mx*tcx + 4*dw*dy*mw*my*tcy + 4*dx*dz*mw*mx*tcx - 4*dw*dy*mx*mz*tcy + 4*dx*dz*mw*my*tcy + 4*dw*dy*my*mz*tcx - 4*dx*dz*mx*mz*tcy + 4*dx*dz*my*mz*tcx)*cos(phi) + (- tcx*dw^2*mw^2 + 2*tcy*dw^2*mw*mz + tcx*dw^2*mz^2 + 2*tcy*dw*dz*mw^2 + 4*tcx*dw*dz*mw*mz - 2*tcy*dw*dz*mz^2 - tcx*dx^2*mw^2 + 2*tcy*dx^2*mw*mz + tcx*dx^2*mz^2 - 2*tcy*dx*dy*mw^2 - 4*tcx*dx*dy*mw*mz + 2*tcy*dx*dy*mz^2 + tcx*dy^2*mw^2 - 2*tcy*dy^2*mw*mz - tcx*dy^2*mz^2 + tcx*dz^2*mw^2 - 2*tcy*dz^2*mw*mz - tcx*dz^2*mz^2)*sin(phi + theta) + (- tcx*dw^2*mx^2 - 2*tcy*dw^2*mx*my + tcx*dw^2*my^2 - 2*tcy*dw*dz*mx^2 + 4*tcx*dw*dz*mx*my + 2*tcy*dw*dz*my^2 - tcx*dx^2*mx^2 - 2*tcy*dx^2*mx*my + tcx*dx^2*my^2 + 2*tcy*dx*dy*mx^2 - 4*tcx*dx*dy*mx*my - 2*tcy*dx*dy*my^2 + tcx*dy^2*mx^2 + 2*tcy*dy^2*mx*my - tcx*dy^2*my^2 + tcx*dz^2*mx^2 + 2*tcy*dz^2*mx*my - tcx*dz^2*my^2)*sin(phi - theta) + (- tcy*dw^2*mw^2 - 2*tcx*dw^2*mw*mz + tcy*dw^2*mz^2 - 2*tcx*dw*dz*mw^2 + 4*tcy*dw*dz*mw*mz + 2*tcx*dw*dz*mz^2 - tcy*dx^2*mw^2 - 2*tcx*dx^2*mw*mz + tcy*dx^2*mz^2 + 2*tcx*dx*dy*mw^2 - 4*tcy*dx*dy*mw*mz - 2*tcx*dx*dy*mz^2 + tcy*dy^2*mw^2 + 2*tcx*dy^2*mw*mz - tcy*dy^2*mz^2 + tcy*dz^2*mw^2 + 2*tcx*dz^2*mw*mz - tcy*dz^2*mz^2)*cos(phi + theta) + (- tcy*dw^2*mx^2 + 2*tcx*dw^2*mx*my + tcy*dw^2*my^2 + 2*tcx*dw*dz*mx^2 + 4*tcy*dw*dz*mx*my - 2*tcx*dw*dz*my^2 - tcy*dx^2*mx^2 + 2*tcx*dx^2*mx*my + tcy*dx^2*my^2 - 2*tcx*dx*dy*mx^2 - 4*tcy*dx*dy*mx*my + 2*tcx*dx*dy*my^2 + tcy*dy^2*mx^2 - 2*tcx*dy^2*mx*my - tcy*dy^2*my^2 + tcy*dz^2*mx^2 - 2*tcx*dz^2*mx*my - tcy*dz^2*my^2)*cos(phi - theta);
J(2,1) = (dx^2*tmy - dw^2*tmy - dy^2*tmy + dz^2*tmy - 2*dw*dz*tmx - 2*dx*dy*tmx + 2*dw^2*mw*mx*tcz - 2*dx^2*mw*mx*tcz + 2*dy^2*mw*mx*tcz - 2*dz^2*mw*mx*tcz - 2*dw^2*my*mz*tcz + 2*dx^2*my*mz*tcz - 2*dy^2*my*mz*tcz + 2*dz^2*my*mz*tcz - 4*dw*dz*mw*my*tcz - 4*dx*dy*mw*my*tcz - 4*dw*dz*mx*mz*tcz - 4*dx*dy*mx*mz*tcz)*sin(theta) + (dw^2*tmx - dx^2*tmx + dy^2*tmx - dz^2*tmx - 2*dw*dz*tmy - 2*dx*dy*tmy + 2*dw^2*mw*my*tcz - 2*dx^2*mw*my*tcz + 2*dw^2*mx*mz*tcz + 2*dy^2*mw*my*tcz - 2*dx^2*mx*mz*tcz - 2*dz^2*mw*my*tcz + 2*dy^2*mx*mz*tcz - 2*dz^2*mx*mz*tcz + 4*dw*dz*mw*mx*tcz + 4*dx*dy*mw*mx*tcz - 4*dw*dz*my*mz*tcz - 4*dx*dy*my*mz*tcz)*cos(theta) + (- tcy*dw^2*mw^2 - 2*tcx*dw^2*mw*mz + tcy*dw^2*mz^2 - 2*tcx*dw*dz*mw^2 + 4*tcy*dw*dz*mw*mz + 2*tcx*dw*dz*mz^2 + tcy*dx^2*mw^2 + 2*tcx*dx^2*mw*mz - tcy*dx^2*mz^2 - 2*tcx*dx*dy*mw^2 + 4*tcy*dx*dy*mw*mz + 2*tcx*dx*dy*mz^2 - tcy*dy^2*mw^2 - 2*tcx*dy^2*mw*mz + tcy*dy^2*mz^2 + tcy*dz^2*mw^2 + 2*tcx*dz^2*mw*mz - tcy*dz^2*mz^2)*sin(phi + theta) + (- tcy*dw^2*mx^2 + 2*tcx*dw^2*mx*my + tcy*dw^2*my^2 + 2*tcx*dw*dz*mx^2 + 4*tcy*dw*dz*mx*my - 2*tcx*dw*dz*my^2 + tcy*dx^2*mx^2 - 2*tcx*dx^2*mx*my - tcy*dx^2*my^2 + 2*tcx*dx*dy*mx^2 + 4*tcy*dx*dy*mx*my - 2*tcx*dx*dy*my^2 - tcy*dy^2*mx^2 + 2*tcx*dy^2*mx*my + tcy*dy^2*my^2 + tcy*dz^2*mx^2 - 2*tcx*dz^2*mx*my - tcy*dz^2*my^2)*sin(phi - theta) + (tcx*dw^2*mw^2 - 2*tcy*dw^2*mw*mz - tcx*dw^2*mz^2 - 2*tcy*dw*dz*mw^2 - 4*tcx*dw*dz*mw*mz + 2*tcy*dw*dz*mz^2 - tcx*dx^2*mw^2 + 2*tcy*dx^2*mw*mz + tcx*dx^2*mz^2 - 2*tcy*dx*dy*mw^2 - 4*tcx*dx*dy*mw*mz + 2*tcy*dx*dy*mz^2 + tcx*dy^2*mw^2 - 2*tcy*dy^2*mw*mz - tcx*dy^2*mz^2 - tcx*dz^2*mw^2 + 2*tcy*dz^2*mw*mz + tcx*dz^2*mz^2)*cos(phi + theta) + (tcx*dw^2*mx^2 + 2*tcy*dw^2*mx*my - tcx*dw^2*my^2 + 2*tcy*dw*dz*mx^2 - 4*tcx*dw*dz*mx*my - 2*tcy*dw*dz*my^2 - tcx*dx^2*mx^2 - 2*tcy*dx^2*mx*my + tcx*dx^2*my^2 + 2*tcy*dx*dy*mx^2 - 4*tcx*dx*dy*mx*my - 2*tcy*dx*dy*my^2 + tcx*dy^2*mx^2 + 2*tcy*dy^2*mx*my - tcx*dy^2*my^2 - tcx*dz^2*mx^2 - 2*tcy*dz^2*mx*my + tcx*dz^2*my^2)*cos(phi - theta);
J(2,2) = (4*dw*dx*mw*mx*tcy - 4*dw*dx*mw*my*tcx + 4*dw*dx*mx*mz*tcx + 4*dw*dx*my*mz*tcy - 4*dy*dz*mw*mx*tcy + 4*dy*dz*mw*my*tcx - 4*dy*dz*mx*mz*tcx - 4*dy*dz*my*mz*tcy)*sin(phi) + (4*dw*dx*mx*mz*tcy - 4*dw*dx*mw*my*tcy - 4*dw*dx*mw*mx*tcx - 4*dw*dx*my*mz*tcx + 4*dy*dz*mw*mx*tcx + 4*dy*dz*mw*my*tcy - 4*dy*dz*mx*mz*tcy + 4*dy*dz*my*mz*tcx)*cos(phi) + (- tcy*dw^2*mw^2 - 2*tcx*dw^2*mw*mz + tcy*dw^2*mz^2 - 2*tcx*dw*dz*mw^2 + 4*tcy*dw*dz*mw*mz + 2*tcx*dw*dz*mz^2 + tcy*dx^2*mw^2 + 2*tcx*dx^2*mw*mz - tcy*dx^2*mz^2 - 2*tcx*dx*dy*mw^2 + 4*tcy*dx*dy*mw*mz + 2*tcx*dx*dy*mz^2 - tcy*dy^2*mw^2 - 2*tcx*dy^2*mw*mz + tcy*dy^2*mz^2 + tcy*dz^2*mw^2 + 2*tcx*dz^2*mw*mz - tcy*dz^2*mz^2)*sin(phi + theta) + (tcy*dw^2*mx^2 - 2*tcx*dw^2*mx*my - tcy*dw^2*my^2 - 2*tcx*dw*dz*mx^2 - 4*tcy*dw*dz*mx*my + 2*tcx*dw*dz*my^2 - tcy*dx^2*mx^2 + 2*tcx*dx^2*mx*my + tcy*dx^2*my^2 - 2*tcx*dx*dy*mx^2 - 4*tcy*dx*dy*mx*my + 2*tcx*dx*dy*my^2 + tcy*dy^2*mx^2 - 2*tcx*dy^2*mx*my - tcy*dy^2*my^2 - tcy*dz^2*mx^2 + 2*tcx*dz^2*mx*my + tcy*dz^2*my^2)*sin(phi - theta) + (tcx*dw^2*mw^2 - 2*tcy*dw^2*mw*mz - tcx*dw^2*mz^2 - 2*tcy*dw*dz*mw^2 - 4*tcx*dw*dz*mw*mz + 2*tcy*dw*dz*mz^2 - tcx*dx^2*mw^2 + 2*tcy*dx^2*mw*mz + tcx*dx^2*mz^2 - 2*tcy*dx*dy*mw^2 - 4*tcx*dx*dy*mw*mz + 2*tcy*dx*dy*mz^2 + tcx*dy^2*mw^2 - 2*tcy*dy^2*mw*mz - tcx*dy^2*mz^2 - tcx*dz^2*mw^2 + 2*tcy*dz^2*mw*mz + tcx*dz^2*mz^2)*cos(phi + theta) + (- tcx*dw^2*mx^2 - 2*tcy*dw^2*mx*my + tcx*dw^2*my^2 - 2*tcy*dw*dz*mx^2 + 4*tcx*dw*dz*mx*my + 2*tcy*dw*dz*my^2 + tcx*dx^2*mx^2 + 2*tcy*dx^2*mx*my - tcx*dx^2*my^2 - 2*tcy*dx*dy*mx^2 + 4*tcx*dx*dy*mx*my + 2*tcy*dx*dy*my^2 - tcx*dy^2*mx^2 - 2*tcy*dy^2*mx*my + tcx*dy^2*my^2 + tcx*dz^2*mx^2 + 2*tcy*dz^2*mx*my - tcx*dz^2*my^2)*cos(phi - theta);
J(3,1) = (2*dw*dy*tmx - 2*dw*dx*tmy - 2*dx*dz*tmx - 2*dy*dz*tmy + 4*dw*dx*mw*mx*tcz + 4*dw*dy*mw*my*tcz - 4*dw*dx*my*mz*tcz + 4*dw*dy*mx*mz*tcz - 4*dx*dz*mw*my*tcz + 4*dy*dz*mw*mx*tcz - 4*dx*dz*mx*mz*tcz - 4*dy*dz*my*mz*tcz)*sin(theta) + (2*dw*dx*tmx + 2*dw*dy*tmy - 2*dx*dz*tmy + 2*dy*dz*tmx + 4*dw*dx*mw*my*tcz - 4*dw*dy*mw*mx*tcz + 4*dw*dx*mx*mz*tcz + 4*dx*dz*mw*mx*tcz + 4*dw*dy*my*mz*tcz + 4*dy*dz*mw*my*tcz - 4*dx*dz*my*mz*tcz + 4*dy*dz*mx*mz*tcz)*cos(theta) + (2*dw*dy*mw^2*tcx - 2*dw*dx*mw^2*tcy - 2*dx*dz*mw^2*tcx + 2*dw*dx*mz^2*tcy - 2*dw*dy*mz^2*tcx - 2*dy*dz*mw^2*tcy + 2*dx*dz*mz^2*tcx + 2*dy*dz*mz^2*tcy - 4*dw*dx*mw*mz*tcx - 4*dw*dy*mw*mz*tcy + 4*dx*dz*mw*mz*tcy - 4*dy*dz*mw*mz*tcx)*sin(phi + theta) + (2*dw*dx*my^2*tcy - 2*dw*dy*mx^2*tcx - 2*dw*dx*mx^2*tcy + 2*dw*dy*my^2*tcx + 2*dx*dz*mx^2*tcx - 2*dx*dz*my^2*tcx - 2*dy*dz*mx^2*tcy + 2*dy*dz*my^2*tcy + 4*dw*dx*mx*my*tcx - 4*dw*dy*mx*my*tcy + 4*dx*dz*mx*my*tcy + 4*dy*dz*mx*my*tcx)*sin(phi - theta) + (2*dw*dx*mw^2*tcx + 2*dw*dy*mw^2*tcy - 2*dw*dx*mz^2*tcx - 2*dx*dz*mw^2*tcy + 2*dy*dz*mw^2*tcx - 2*dw*dy*mz^2*tcy + 2*dx*dz*mz^2*tcy - 2*dy*dz*mz^2*tcx - 4*dw*dx*mw*mz*tcy + 4*dw*dy*mw*mz*tcx - 4*dx*dz*mw*mz*tcx - 4*dy*dz*mw*mz*tcy)*cos(phi + theta) + (2*dw*dx*mx^2*tcx - 2*dw*dx*my^2*tcx - 2*dw*dy*mx^2*tcy + 2*dw*dy*my^2*tcy + 2*dx*dz*mx^2*tcy + 2*dy*dz*mx^2*tcx - 2*dx*dz*my^2*tcy - 2*dy*dz*my^2*tcx + 4*dw*dx*mx*my*tcy + 4*dw*dy*mx*my*tcx - 4*dx*dz*mx*my*tcx + 4*dy*dz*mx*my*tcy)*cos(phi - theta);
J(3,2) = (2*dw^2*mw*my*tcx - 2*dw^2*mw*mx*tcy + 2*dx^2*mw*mx*tcy - 2*dx^2*mw*my*tcx + 2*dy^2*mw*mx*tcy - 2*dw^2*mx*mz*tcx - 2*dy^2*mw*my*tcx - 2*dz^2*mw*mx*tcy + 2*dx^2*mx*mz*tcx + 2*dz^2*mw*my*tcx - 2*dw^2*my*mz*tcy + 2*dy^2*mx*mz*tcx + 2*dx^2*my*mz*tcy - 2*dz^2*mx*mz*tcx + 2*dy^2*my*mz*tcy - 2*dz^2*my*mz*tcy)*sin(phi) + (2*dw^2*mw*mx*tcx - 2*dx^2*mw*mx*tcx + 2*dw^2*mw*my*tcy - 2*dy^2*mw*mx*tcx - 2*dx^2*mw*my*tcy + 2*dz^2*mw*mx*tcx - 2*dw^2*mx*mz*tcy - 2*dy^2*mw*my*tcy + 2*dw^2*my*mz*tcx + 2*dx^2*mx*mz*tcy + 2*dz^2*mw*my*tcy - 2*dx^2*my*mz*tcx + 2*dy^2*mx*mz*tcy - 2*dy^2*my*mz*tcx - 2*dz^2*mx*mz*tcy + 2*dz^2*my*mz*tcx)*cos(phi) + (2*dw*dy*mw^2*tcx - 2*dw*dx*mw^2*tcy - 2*dx*dz*mw^2*tcx + 2*dw*dx*mz^2*tcy - 2*dw*dy*mz^2*tcx - 2*dy*dz*mw^2*tcy + 2*dx*dz*mz^2*tcx + 2*dy*dz*mz^2*tcy - 4*dw*dx*mw*mz*tcx - 4*dw*dy*mw*mz*tcy + 4*dx*dz*mw*mz*tcy - 4*dy*dz*mw*mz*tcx)*sin(phi + theta) + (2*dw*dx*mx^2*tcy + 2*dw*dy*mx^2*tcx - 2*dw*dx*my^2*tcy - 2*dw*dy*my^2*tcx - 2*dx*dz*mx^2*tcx + 2*dx*dz*my^2*tcx + 2*dy*dz*mx^2*tcy - 2*dy*dz*my^2*tcy - 4*dw*dx*mx*my*tcx + 4*dw*dy*mx*my*tcy - 4*dx*dz*mx*my*tcy - 4*dy*dz*mx*my*tcx)*sin(phi - theta) + (2*dw*dx*mw^2*tcx + 2*dw*dy*mw^2*tcy - 2*dw*dx*mz^2*tcx - 2*dx*dz*mw^2*tcy + 2*dy*dz*mw^2*tcx - 2*dw*dy*mz^2*tcy + 2*dx*dz*mz^2*tcy - 2*dy*dz*mz^2*tcx - 4*dw*dx*mw*mz*tcy + 4*dw*dy*mw*mz*tcx - 4*dx*dz*mw*mz*tcx - 4*dy*dz*mw*mz*tcy)*cos(phi + theta) + (2*dw*dx*my^2*tcx - 2*dw*dx*mx^2*tcx + 2*dw*dy*mx^2*tcy - 2*dw*dy*my^2*tcy - 2*dx*dz*mx^2*tcy - 2*dy*dz*mx^2*tcx + 2*dx*dz*my^2*tcy + 2*dy*dz*my^2*tcx - 4*dw*dx*mx*my*tcy - 4*dw*dy*mx*my*tcx + 4*dx*dz*mx*my*tcx - 4*dy*dz*mx*my*tcy)*cos(phi - theta);
J(4,1) = ((cx*dz*my)/2 - (cx*dw*mx)/2 - (cw*dy*my)/2 - (cy*dw*my)/2 - (cw*dx*mx)/2 - (cy*dz*mx)/2 - (cz*dx*my)/2 + (cz*dy*mx)/2)*sin(phi/2 - theta/2) + ((cx*dx*mw)/2 - (cw*dw*mw)/2 + (cy*dy*mw)/2 + (cw*dz*mz)/2 + (cx*dy*mz)/2 - (cy*dx*mz)/2 + (cz*dw*mz)/2 + (cz*dz*mw)/2)*sin(phi/2 + theta/2) + ((cw*dx*my)/2 - (cw*dy*mx)/2 + (cx*dw*my)/2 - (cy*dw*mx)/2 + (cx*dz*mx)/2 - (cz*dx*mx)/2 + (cy*dz*my)/2 - (cz*dy*my)/2)*cos(phi/2 - theta/2) + ((cy*dx*mw)/2 - (cw*dz*mw)/2 - (cx*dy*mw)/2 - (cw*dw*mz)/2 - (cz*dw*mw)/2 + (cx*dx*mz)/2 + (cy*dy*mz)/2 + (cz*dz*mz)/2)*cos(phi/2 + theta/2);
J(4,2) = ((cw*dx*mx)/2 + (cx*dw*mx)/2 + (cw*dy*my)/2 + (cy*dw*my)/2 - (cx*dz*my)/2 + (cy*dz*mx)/2 + (cz*dx*my)/2 - (cz*dy*mx)/2)*sin(phi/2 - theta/2) + ((cx*dx*mw)/2 - (cw*dw*mw)/2 + (cy*dy*mw)/2 + (cw*dz*mz)/2 + (cx*dy*mz)/2 - (cy*dx*mz)/2 + (cz*dw*mz)/2 + (cz*dz*mw)/2)*sin(phi/2 + theta/2) + ((cw*dy*mx)/2 - (cw*dx*my)/2 - (cx*dw*my)/2 + (cy*dw*mx)/2 - (cx*dz*mx)/2 + (cz*dx*mx)/2 - (cy*dz*my)/2 + (cz*dy*my)/2)*cos(phi/2 - theta/2) + ((cy*dx*mw)/2 - (cw*dz*mw)/2 - (cx*dy*mw)/2 - (cw*dw*mz)/2 - (cz*dw*mw)/2 + (cx*dx*mz)/2 + (cy*dy*mz)/2 + (cz*dz*mz)/2)*cos(phi/2 + theta/2);
J(5,1) = ((cw*dw*mx)/2 - (cx*dx*mx)/2 - (cw*dz*my)/2 - (cx*dy*my)/2 - (cy*dx*my)/2 + (cy*dy*mx)/2 + (cz*dw*my)/2 + (cz*dz*mx)/2)*sin(phi/2 - theta/2) + ((cy*dw*mz)/2 - (cx*dw*mw)/2 - (cw*dy*mz)/2 - (cw*dx*mw)/2 + (cy*dz*mw)/2 - (cz*dy*mw)/2 + (cx*dz*mz)/2 + (cz*dx*mz)/2)*sin(phi/2 + theta/2) + ((cx*dx*my)/2 - (cw*dz*mx)/2 - (cw*dw*my)/2 - (cx*dy*mx)/2 - (cy*dx*mx)/2 + (cz*dw*mx)/2 - (cy*dy*my)/2 - (cz*dz*my)/2)*cos(phi/2 - theta/2) + ((cw*dy*mw)/2 - (cy*dw*mw)/2 - (cw*dx*mz)/2 - (cx*dw*mz)/2 - (cx*dz*mw)/2 - (cz*dx*mw)/2 + (cy*dz*mz)/2 - (cz*dy*mz)/2)*cos(phi/2 + theta/2);
J(5,2) = ((cx*dx*mx)/2 - (cw*dw*mx)/2 + (cw*dz*my)/2 + (cx*dy*my)/2 + (cy*dx*my)/2 - (cy*dy*mx)/2 - (cz*dw*my)/2 - (cz*dz*mx)/2)*sin(phi/2 - theta/2) + ((cy*dw*mz)/2 - (cx*dw*mw)/2 - (cw*dy*mz)/2 - (cw*dx*mw)/2 + (cy*dz*mw)/2 - (cz*dy*mw)/2 + (cx*dz*mz)/2 + (cz*dx*mz)/2)*sin(phi/2 + theta/2) + ((cw*dw*my)/2 + (cw*dz*mx)/2 - (cx*dx*my)/2 + (cx*dy*mx)/2 + (cy*dx*mx)/2 - (cz*dw*mx)/2 + (cy*dy*my)/2 + (cz*dz*my)/2)*cos(phi/2 - theta/2) + ((cw*dy*mw)/2 - (cy*dw*mw)/2 - (cw*dx*mz)/2 - (cx*dw*mz)/2 - (cx*dz*mw)/2 - (cz*dx*mw)/2 + (cy*dz*mz)/2 - (cz*dy*mz)/2)*cos(phi/2 + theta/2);
J(6,1) = ((cw*dw*my)/2 + (cw*dz*mx)/2 + (cx*dx*my)/2 - (cx*dy*mx)/2 - (cy*dx*mx)/2 - (cz*dw*mx)/2 - (cy*dy*my)/2 + (cz*dz*my)/2)*sin(phi/2 - theta/2) + ((cw*dx*mz)/2 - (cy*dw*mw)/2 - (cw*dy*mw)/2 - (cx*dw*mz)/2 - (cx*dz*mw)/2 + (cz*dx*mw)/2 + (cy*dz*mz)/2 + (cz*dy*mz)/2)*sin(phi/2 + theta/2) + ((cw*dw*mx)/2 + (cx*dx*mx)/2 - (cw*dz*my)/2 + (cx*dy*my)/2 + (cy*dx*my)/2 - (cy*dy*mx)/2 + (cz*dw*my)/2 + (cz*dz*mx)/2)*cos(phi/2 - theta/2) + ((cx*dw*mw)/2 - (cw*dx*mw)/2 - (cw*dy*mz)/2 - (cy*dw*mz)/2 - (cy*dz*mw)/2 - (cz*dy*mw)/2 - (cx*dz*mz)/2 + (cz*dx*mz)/2)*cos(phi/2 + theta/2);
J(6,2) = ((cx*dy*mx)/2 - (cw*dz*mx)/2 - (cx*dx*my)/2 - (cw*dw*my)/2 + (cy*dx*mx)/2 + (cz*dw*mx)/2 + (cy*dy*my)/2 - (cz*dz*my)/2)*sin(phi/2 - theta/2) + ((cw*dx*mz)/2 - (cy*dw*mw)/2 - (cw*dy*mw)/2 - (cx*dw*mz)/2 - (cx*dz*mw)/2 + (cz*dx*mw)/2 + (cy*dz*mz)/2 + (cz*dy*mz)/2)*sin(phi/2 + theta/2) + ((cw*dz*my)/2 - (cx*dx*mx)/2 - (cw*dw*mx)/2 - (cx*dy*my)/2 - (cy*dx*my)/2 + (cy*dy*mx)/2 - (cz*dw*my)/2 - (cz*dz*mx)/2)*cos(phi/2 - theta/2) + ((cx*dw*mw)/2 - (cw*dx*mw)/2 - (cw*dy*mz)/2 - (cy*dw*mz)/2 - (cy*dz*mw)/2 - (cz*dy*mw)/2 - (cx*dz*mz)/2 + (cz*dx*mz)/2)*cos(phi/2 + theta/2);
J(7,1) = ((cw*dx*my)/2 - (cw*dy*mx)/2 - (cx*dw*my)/2 + (cy*dw*mx)/2 - (cx*dz*mx)/2 - (cz*dx*mx)/2 - (cy*dz*my)/2 - (cz*dy*my)/2)*sin(phi/2 - theta/2) + ((cx*dy*mw)/2 - (cw*dz*mw)/2 - (cw*dw*mz)/2 - (cy*dx*mw)/2 - (cz*dw*mw)/2 - (cx*dx*mz)/2 - (cy*dy*mz)/2 + (cz*dz*mz)/2)*sin(phi/2 + theta/2) + ((cw*dx*mx)/2 - (cx*dw*mx)/2 + (cw*dy*my)/2 - (cy*dw*my)/2 + (cx*dz*my)/2 - (cy*dz*mx)/2 + (cz*dx*my)/2 - (cz*dy*mx)/2)*cos(phi/2 - theta/2) + ((cw*dw*mw)/2 + (cx*dx*mw)/2 + (cy*dy*mw)/2 - (cw*dz*mz)/2 + (cx*dy*mz)/2 - (cy*dx*mz)/2 - (cz*dw*mz)/2 - (cz*dz*mw)/2)*cos(phi/2 + theta/2);
J(7,2) = ((cw*dy*mx)/2 - (cw*dx*my)/2 + (cx*dw*my)/2 - (cy*dw*mx)/2 + (cx*dz*mx)/2 + (cz*dx*mx)/2 + (cy*dz*my)/2 + (cz*dy*my)/2)*sin(phi/2 - theta/2) + ((cx*dy*mw)/2 - (cw*dz*mw)/2 - (cw*dw*mz)/2 - (cy*dx*mw)/2 - (cz*dw*mw)/2 - (cx*dx*mz)/2 - (cy*dy*mz)/2 + (cz*dz*mz)/2)*sin(phi/2 + theta/2) + ((cx*dw*mx)/2 - (cw*dx*mx)/2 - (cw*dy*my)/2 + (cy*dw*my)/2 - (cx*dz*my)/2 + (cy*dz*mx)/2 - (cz*dx*my)/2 + (cz*dy*mx)/2)*cos(phi/2 - theta/2) + ((cw*dw*mw)/2 + (cx*dx*mw)/2 + (cy*dy*mw)/2 - (cw*dz*mz)/2 + (cx*dy*mz)/2 - (cy*dx*mz)/2 - (cz*dw*mz)/2 - (cz*dz*mw)/2)*cos(phi/2 + theta/2);

end 